import{_ as g,c as v,o as f,w as t,a as s,Q as _,b as n,f as r,ae as b,a7 as d,d as l}from"./index-Mwczm3Jn.js";import{Q as c}from"./QSelect-Dio5GSdy.js";import{Q as V}from"./QForm-RiouWTWd.js";import{Q as h}from"./QSpinnerDots-DDv640To.js";import{Q as x}from"./QInnerLoading-BeUEe0_5.js";import{Q}from"./QPage-F8fVnEV4.js";import"./QChip-D84Fihgf.js";import"./QItem-B-jDGqV1.js";import"./QItemLabel-BultT7H3.js";import"./format-CIujHQBD.js";import"./selection-CxySlGwV.js";const y={name:"AsignacionEdit",data(){return{asignacion:{curso_id:null,docente_id:null,unidadEducativa:"",taller:"",fases:"",docentesEncargados:"",anioFormacion:"",gestion:null},cursos:[],docentes:[],gestiones:[],loading:!1}},async mounted(){this.loading=!0;try{const[e,u]=await Promise.all([this.$axios.get("cursos"),this.$axios.get("docentes")]);this.cursos=e.data,this.docentes=u.data;const{data:m}=await this.$axios.get(`asignacionesFind/${parseInt(this.$route.params.id)}`);this.asignacion=this.normalizeAsignacion(m)}catch(e){this.$alert.error(e.response?.data?.message||"No se pudo cargar la asignación")}finally{this.loading=!1}const a=new Date().getFullYear();for(let e=a-3;e<=a+3;e++)this.gestiones.push({label:String(e),value:String(e)})},methods:{normalizeAsignacion(a){const e={...a};return!e.curso_id&&a.curso&&(e.curso_id=a.curso.id),!e.docente_id&&a.docente&&(e.docente_id=a.docente.id),e.gestion!=null&&(e.gestion=String(e.gestion)),e},guardarAsignacion(){this.loading=!0,this.$axios.put(`asignaciones/${parseInt(this.$route.params.id)}`,this.asignacion).then(()=>{this.$alert.success("Asignación actualizada"),this.$router.push("/asignaciones")}).catch(a=>this.$alert.error(a.response?.data?.message||"Error al actualizar")).finally(()=>{this.loading=!1})}}},q={class:"row items-center q-mb-md"},E={class:"col-auto"},A={class:"row"},U={class:"col-12 col-md-4"},F={class:"col-12 col-md-4"},w={class:"col-12 col-md-4"},S={class:"row"},C={class:"col-12 col-md-6"},D={class:"col-12 col-md-6"},R={class:"row"},z={class:"col-12 col-md-4"},I={class:"col-12 col-md-4"},k={class:"col-12 col-md-4"},B={class:"row justify-end q-gutter-sm q-mt-lg"};function N(a,e,u,m,i,p){return f(),v(Q,{class:"q-pa-md"},{default:t(()=>[s(_,{flat:"",bordered:"",class:"q-pa-md"},{default:t(()=>[n("div",q,[e[10]||(e[10]=n("div",{class:"col"},[n("div",{class:"text-h6"},"Editar Asignación"),n("div",{class:"text-caption text-grey-7"},"Actualiza los datos y guarda los cambios")],-1)),n("div",E,[s(r,{flat:"",color:"negative",icon:"close",label:"Cancelar","no-caps":"",onClick:e[0]||(e[0]=o=>a.$router.push("/asignaciones"))})])]),s(b,{spaced:""}),s(V,{onSubmit:p.guardarAsignacion,class:"q-gutter-md"},{default:t(()=>[e[11]||(e[11]=n("div",{class:"text-subtitle2 text-grey-8"},"Datos académicos",-1)),n("div",A,[n("div",U,[s(d,{modelValue:i.asignacion.anioFormacion,"onUpdate:modelValue":e[1]||(e[1]=o=>i.asignacion.anioFormacion=o),label:"Año de Formación",dense:"",outlined:"",rules:[o=>!!o||"Requerido"]},{prepend:t(()=>[s(l,{name:"school"})]),_:1},8,["modelValue","rules"])]),n("div",F,[s(c,{modelValue:i.asignacion.gestion,"onUpdate:modelValue":e[2]||(e[2]=o=>i.asignacion.gestion=o),options:i.gestiones,label:"Gestión",dense:"",outlined:"","emit-value":"","map-options":"",rules:[o=>!!o||"Requerido"]},{prepend:t(()=>[s(l,{name:"event"})]),_:1},8,["modelValue","options","rules"])]),n("div",w,[s(c,{modelValue:i.asignacion.curso_id,"onUpdate:modelValue":e[3]||(e[3]=o=>i.asignacion.curso_id=o),options:i.cursos,"option-label":"nombre","option-value":"id",label:"Unidad de Formación (Curso)",dense:"",outlined:"","emit-value":"","map-options":"",rules:[o=>!!o||"Requerido"]},{prepend:t(()=>[s(l,{name:"menu_book"})]),_:1},8,["modelValue","options","rules"])])]),e[12]||(e[12]=n("div",{class:"text-subtitle2 text-grey-8 q-mt-md"},"Docencia",-1)),n("div",S,[n("div",C,[s(c,{modelValue:i.asignacion.docente_id,"onUpdate:modelValue":e[4]||(e[4]=o=>i.asignacion.docente_id=o),options:i.docentes,"option-label":"nombre","option-value":"id",label:"Docente",dense:"",outlined:"","emit-value":"","map-options":"",rules:[o=>!!o||"Requerido"]},{prepend:t(()=>[s(l,{name:"person"})]),_:1},8,["modelValue","options","rules"])]),n("div",D,[s(d,{modelValue:i.asignacion.unidadEducativa,"onUpdate:modelValue":e[5]||(e[5]=o=>i.asignacion.unidadEducativa=o),label:"Unidad Educativa",dense:"",outlined:"",rules:[o=>!!o||"Requerido"]},{prepend:t(()=>[s(l,{name:"apartment"})]),_:1},8,["modelValue","rules"])])]),e[13]||(e[13]=n("div",{class:"text-subtitle2 text-grey-8 q-mt-md"},"Detalle",-1)),n("div",R,[n("div",z,[s(d,{modelValue:i.asignacion.taller,"onUpdate:modelValue":e[6]||(e[6]=o=>i.asignacion.taller=o),label:"Taller",dense:"",outlined:""},{prepend:t(()=>[s(l,{name:"category"})]),_:1},8,["modelValue"])]),n("div",I,[s(d,{modelValue:i.asignacion.fases,"onUpdate:modelValue":e[7]||(e[7]=o=>i.asignacion.fases=o),label:"Fases",dense:"",outlined:""},{prepend:t(()=>[s(l,{name:"timeline"})]),_:1},8,["modelValue"])]),n("div",k,[s(d,{modelValue:i.asignacion.docentesEncargados,"onUpdate:modelValue":e[8]||(e[8]=o=>i.asignacion.docentesEncargados=o),label:"Docentes Encargados",dense:"",outlined:""},{prepend:t(()=>[s(l,{name:"groups"})]),_:1},8,["modelValue"])])]),n("div",B,[s(r,{flat:"",color:"negative",icon:"close",label:"Cancelar","no-caps":"",onClick:e[9]||(e[9]=o=>a.$router.push("/asignaciones"))}),s(r,{color:"primary",icon:"save",label:"Guardar cambios","no-caps":"",type:"submit",loading:i.loading},null,8,["loading"])])]),_:1},8,["onSubmit"]),s(x,{showing:i.loading},{default:t(()=>[s(h,{size:"32px"})]),_:1},8,["showing"])]),_:1})]),_:1})}const W=g(y,[["render",N],["__scopeId","data-v-72dbcb05"]]);export{W as default};
