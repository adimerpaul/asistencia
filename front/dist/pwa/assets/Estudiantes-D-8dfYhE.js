import{_ as V,c as r,o as u,w as s,a as e,W as m,d as f,Z as g,f as c,a7 as n,h as _,Q as C,e as b,b as h,t as v}from"./index-0jewawln.js";import{Q as E,a as d}from"./QItem-CYzMF0Lo.js";import{a as x}from"./format-XBwitZhB.js";import{Q as k,C as p}from"./ClosePopup-BAAl4YOq.js";import{Q as q}from"./QTd-DrazB54k.js";import{Q as w}from"./QTable-Cnm8kST3.js";import{Q as y}from"./QForm-NhSMC-Iu.js";import{Q as N}from"./QPage-CTGj8175.js";import"./selection-ZwgMqj-P.js";import"./use-fullscreen-CxoFJyAm.js";const B={name:"EstudiantesPage",data(){return{estudiantes:[],estudiante:{},dialog:!1,loading:!1,filter:"",columns:[{name:"actions",label:"Acciones",align:"center"},{name:"nombre",label:"Nombre",field:"nombre",align:"left"},{name:"ci",label:"CI",field:"ci",align:"left"},{name:"email",label:"Email",field:"email",align:"left"},{name:"telefono",label:"Teléfono",field:"telefono",align:"left"}]}},mounted(){this.obtenerEstudiantes()},methods:{obtenerEstudiantes(){this.loading=!0,this.$axios.get("estudiantes").then(i=>{this.estudiantes=i.data}).catch(i=>{this.$alert.error(i.response?.data?.message||"Error al obtener estudiantes")}).finally(()=>{this.loading=!1})},nuevoEstudiante(){this.estudiante={},this.dialog=!0},editarEstudiante(i){this.estudiante={...i},this.dialog=!0},guardarEstudiante(){this.loading=!0,(this.estudiante.id?this.$axios.put(`estudiantes/${this.estudiante.id}`,this.estudiante):this.$axios.post("estudiantes",this.estudiante)).then(()=>{this.$alert.success("Estudiante guardado"),this.dialog=!1,this.obtenerEstudiantes()}).catch(t=>{this.$alert.error(t.response?.data?.message||"Error al guardar")}).finally(()=>{this.loading=!1})},eliminarEstudiante(i){this.$alert.dialog("¿Desea eliminar este estudiante?").onOk(()=>{this.loading=!0,this.$axios.delete(`estudiantes/${i}`).then(()=>{this.$alert.success("Estudiante eliminado"),this.obtenerEstudiantes()}).catch(t=>{this.$alert.error(t.response?.data?.message||"Error al eliminar")}).finally(()=>{this.loading=!1})})}}},I={class:"text-h6"},U={class:"text-right"};function D(i,t,S,T,a,o){return u(),r(N,{class:"q-pa-md"},{default:s(()=>[e(w,{rows:a.estudiantes,columns:a.columns,flat:"",bordered:"",dense:"","wrap-cells":"","rows-per-page-options":[0],title:"Estudiantes",filter:a.filter},{"top-right":s(()=>[e(c,{label:"Nuevo",icon:"add_circle_outline",color:"primary",onClick:o.nuevoEstudiante,loading:a.loading,"no-caps":""},null,8,["onClick","loading"]),e(n,{modelValue:a.filter,"onUpdate:modelValue":t[0]||(t[0]=l=>a.filter=l),label:"Buscar",dense:"",outlined:"",class:"q-ml-sm"},{append:s(()=>[e(f,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-actions":s(l=>[e(q,{props:l},{default:s(()=>[e(k,{label:"Acciones",color:"primary",size:"sm","no-caps":""},{default:s(()=>[e(x,null,{default:s(()=>[m((u(),r(E,{clickable:"",onClick:Q=>o.editarEstudiante(l.row)},{default:s(()=>[e(d,{avatar:""},{default:s(()=>[e(f,{name:"edit"})]),_:1}),e(d,null,{default:s(()=>t[6]||(t[6]=[g("Editar")])),_:1})]),_:2},1032,["onClick"])),[[p]]),m((u(),r(E,{clickable:"",onClick:Q=>o.eliminarEstudiante(l.row.id)},{default:s(()=>[e(d,{avatar:""},{default:s(()=>[e(f,{name:"delete"})]),_:1}),e(d,null,{default:s(()=>t[7]||(t[7]=[g("Eliminar")])),_:1})]),_:2},1032,["onClick"])),[[p]])]),_:2},1024)]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","columns","filter"]),e(_,{modelValue:a.dialog,"onUpdate:modelValue":t[5]||(t[5]=l=>a.dialog=l),persistent:""},{default:s(()=>[e(C,{style:{width:"400px"}},{default:s(()=>[e(b,null,{default:s(()=>[h("div",I,v(a.estudiante.id?"Editar":"Nuevo")+" Estudiante",1)]),_:1}),e(b,null,{default:s(()=>[e(y,{onSubmit:o.guardarEstudiante},{default:s(()=>[e(n,{modelValue:a.estudiante.nombre,"onUpdate:modelValue":t[1]||(t[1]=l=>a.estudiante.nombre=l),label:"Nombre",dense:"",outlined:"",class:"q-mb-sm",rules:[l=>!!l||"Requerido"]},null,8,["modelValue","rules"]),e(n,{modelValue:a.estudiante.ci,"onUpdate:modelValue":t[2]||(t[2]=l=>a.estudiante.ci=l),label:"CI",dense:"",outlined:"",class:"q-mb-sm",rules:[l=>!!l||"Requerido"]},null,8,["modelValue","rules"]),e(n,{modelValue:a.estudiante.email,"onUpdate:modelValue":t[3]||(t[3]=l=>a.estudiante.email=l),label:"Email",dense:"",outlined:"",class:"q-mb-sm",type:"email"},null,8,["modelValue"]),e(n,{modelValue:a.estudiante.telefono,"onUpdate:modelValue":t[4]||(t[4]=l=>a.estudiante.telefono=l),label:"Teléfono",dense:"",outlined:"",class:"q-mb-sm"},null,8,["modelValue"]),h("div",U,[m(e(c,{flat:"",label:"Cancelar",color:"negative"},null,512),[[p]]),e(c,{label:"Guardar",type:"submit",color:"primary",class:"q-ml-sm",loading:a.loading},null,8,["loading"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const j=V(B,[["render",D]]);export{j as default};
